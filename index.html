<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>GO APPLE — Catálogo</title>
<style>
  :root{
    --bg:#ffffff; --surface:#ffffff; --surface-2:#f5f5f7; --line:#e6e6e9;
    --ink:#1d1d1f; --muted:#6e6e73; --accent:#0071e3;
    --radius:14px; --gap:10px; --card-h-sm: 200px;
  }
  *{box-sizing:border-box} html,body{height:100%}
  body{ margin:0; background:var(--bg); color:var(--ink);
        font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","SF Pro Display",Segoe UI,Roboto,Helvetica,Arial,sans-serif; }

  .apple-nav{ position:sticky; top:0; z-index:20; height:44px; border-bottom:1px solid var(--line);
    backdrop-filter:saturate(1.8) blur(20px); background:rgba(255,255,255,.86); }
  .nav-inner{ max-width:1200px; margin:0 auto; height:100%;
    display:flex; align-items:center; justify-content:center; padding:0 12px; }
  .brand{ display:flex; align-items:center; gap:8px; text-decoration:none; color:inherit; }
  .logo-img{ height:22px; width:auto; display:block; }
  .logo-fallback{ font-weight:800; font-size:16px; letter-spacing:.2px; }

  .hero{ max-width:1200px; margin:10px auto 0; padding:8px 12px 0; }
  .hero h1{ margin:0; font-size:28px; line-height:1.1; font-weight:800; }

  main .grid{
    display:grid; gap:var(--gap);
    grid-template-columns:repeat(2, minmax(0, 1fr));
    grid-auto-rows: var(--card-h-sm);
    padding:10px; max-width:1200px; margin:0 auto;
  }
  @media (min-width:600px){ main .grid{ grid-template-columns:repeat(3, minmax(0, 1fr)); } }
  @media (min-width:992px){ main .grid{ grid-template-columns:repeat(4, minmax(0, 1fr)); grid-auto-rows:auto; } }

  .card{
    position:relative;
    background:var(--surface); border:1px solid var(--line); border-radius:var(--radius);
    display:flex; flex-direction:column; overflow:hidden;
    transition:transform .2s, box-shadow .2s, border-color .2s;
  }
  .card:hover{ transform:translateY(-2px); box-shadow:0 12px 26px rgba(0,0,0,.06); border-color:#dcdde2; }
  .card-hit{ position:absolute; inset:0; border:0; background:transparent; cursor:pointer; }
  .img{ position:relative; background:var(--surface-2); display:flex; align-items:center; justify-content:center; flex:1 1 58%; min-height:0; }
  .img img{ width:86%; height:86%; object-fit:contain; }
  .no-img{ color:var(--muted); font-size:13px; }
  .status{
    position:absolute; top:8px; left:8px; padding:4px 10px; border-radius:999px;
    background:#f2f2f7; border:1px solid var(--line); color:#3a3a3c; font-size:11px; font-weight:600;
  }
  .info{ flex:1 1 42%; padding:10px 10px 12px; display:flex; flex-direction:column; gap:6px; }
  .name{ margin:0; font-weight:800; font-size:15px; line-height:1.15;
    display:-webkit-box; -webkit-line-clamp:1; -webkit-box-orient:vertical; overflow:hidden; }
  .price{ font-size:18px; font-weight:800; color:#000; }
  .sub{ font-size:12.5px; color:#0071e3; font-weight:600; }
  .meta{ display:flex; flex-wrap:wrap; gap:6px; }
  .chip{ background:#f6f7f8; border:1px solid var(--line); color:#1d1d1f;
    font-size:12px; padding:5px 8px; border-radius:999px; display:inline-flex; align-items:center; gap:6px; }
  .dot{ width:10px; height:10px; border-radius:999px; background:var(--dot, #d1d5db); border:1px solid rgba(0,0,0,.08); }

  [data-status="vendido"] .status{ background:#fff0f0; color:#b00020; border-color:#ffd6d6; }
  [data-status="reservado"] .status{ background:#fff8e1; color:#8a6d1f; border-color:#ffe8a3; }
  [data-status="disponible"] .status{ background:#e7f7ee; color:#1b6f43; border-color:#cdebdc; }

  /* POPUP beneficios (ya lo teníamos) */
  .overlay{ position:fixed; inset:0; background:rgba(0,0,0,.45); display:none; align-items:center; justify-content:center; z-index:40; }
  .modal{ width:min(560px,92vw); background:#fff; border:1px solid var(--line); border-radius:20px; box-shadow:0 30px 80px rgba(0,0,0,.25); overflow:hidden; }
  .modal header{ padding:18px 22px 0; text-align:center; }
  .modal h2{ margin:0; font-size:24px; font-weight:800; }
  .modal p.lead{ margin:6px 0 14px; color:#424245; font-size:15px; }
  .benefits{ padding:0 18px 6px; }
  .benefits li{ list-style:none; display:flex; align-items:flex-start; gap:10px; margin:10px 0; color:#1d1d1f; }
  .benefits li .tick{ flex:0 0 auto; width:22px; height:22px; border-radius:999px; display:grid; place-items:center; background:#e6f0ff; color:#0071e3; font-weight:800; }
  .modal footer{ display:flex; gap:10px; justify-content:center; padding:16px 18px 22px; background:#f5f5f7; border-top:1px solid var(--line); }
  .cta{ appearance:none; padding:10px 16px; border-radius:999px; font-weight:700; cursor:pointer; border:1px solid #cfd2d8; background:#fff; }
  .cta.primary{ background:#0071e3; color:#fff; border-color:#0071e3; }
  .cta.primary:hover{ filter:brightness(.98); }
  .cta:hover{ border-color:#bfc4cc; }

  /* DETALLE PRODUCTO */
  .overlay.detail{ z-index:50; }
  .modal.detail{ width:min(900px,96vw); display:grid; grid-template-columns:1fr; }
  .detail-media{ background:var(--surface-2); display:grid; place-items:center; padding:24px; border-bottom:1px solid var(--line); }
  .detail-media img{ width:min(520px,88%); height:auto; object-fit:contain; }
  .detail-body{ padding:18px 18px 20px; display:grid; gap:10px; }
  .detail-title{ margin:0; font-size:22px; font-weight:800; }
  .detail-meta{ display:flex; flex-wrap:wrap; gap:8px; }
  .prices{ display:grid; gap:6px; }
  .p-usd{ font-size:20px; font-weight:800; color:#000; }
  .p-ars{ font-size:16px; font-weight:700; color:#111; }
  .p-cuotas{ font-size:13.5px; color:#0071e3; font-weight:600; }
  .detail-actions{ display:flex; gap:8px; justify-content:flex-end; }
  .close-x{ position:absolute; top:10px; right:12px; border:0; background:transparent; font-size:24px; line-height:1; cursor:pointer; }

  @media (min-width:780px){
    .modal.detail{ grid-template-columns:1.1fr 1fr; }
    .detail-media{ border-bottom:0; border-right:1px solid var(--line); }
    .close-x{ top:6px; right:10px; }
  }

  footer{ color:#6e6e73; font-size:12px; text-align:center; padding:16px 12px; border-top:1px solid var(--line); background:#f5f5f7; }
</style>
</head>
<body>

<nav class="apple-nav">
  <div class="nav-inner">
    <a class="brand" href="#" aria-label="GO APPLE">
      <img class="logo-img" src="https://tu-dominio.com/logo.png" alt="GO APPLE"
           onerror="this.nextElementSibling.style.display='inline-block'; this.remove()" />
      <span class="logo-fallback">GO APPLE</span>
    </a>
  </div>
</nav>

<section class="hero">
  <h1>iPhone — Catálogo</h1>
</section>

<main>
  <div class="grid" id="grid">
    
  <article class="card"
    data-idx="0"
    data-name="sin nombre"
    data-status=""
    data-storage="—">
    <button class="card-hit" aria-label="Ver Sin nombre"></button>
    <div class="img"><div class="no-img">Sin imagen</div></div>
    <div class="info">
      <h3 class="name" title="Sin nombre">Sin nombre</h3>
      <div class="price">—</div>
      
      <div class="meta">
        
      </div>
    </div>
  </article>
  </div>
</main>

<!-- Popup beneficios (una vez por sesión) -->
<div class="overlay" id="welcome">
  <div class="modal" role="dialog" aria-labelledby="w-title" aria-modal="true">
    <header>
      <h2 id="w-title">Bienvenido a GO APPLE</h2>
      <p class="lead">Elegí tu iPhone con beneficios que suman de verdad.</p>
    </header>
    <ul class="benefits">
      <li><span class="tick">✓</span><div><strong>Pack de regalo</strong>: funda, cargador, cable y vidrio templado.</div></li>
      <li><span class="tick">✓</span><div><strong>30 días de garantía</strong> de funcionamiento.</div></li>
      <li><span class="tick">✓</span><div><strong>Hasta 6 cuotas fijas</strong> para que pagues cómodo.</div></li>
      <li><span class="tick">✓</span><div><strong>Servicio técnico con descuento</strong> por ser cliente GO APPLE.</div></li>
    </ul>
    <footer>
      <button class="cta" id="dismiss">Después</button>
      <button class="cta primary" id="see">Ver modelos</button>
    </footer>
  </div>
</div>

<!-- Modal de detalle producto -->
<div class="overlay detail" id="detail">
  <div class="modal detail" role="dialog" aria-labelledby="d-title" aria-modal="true">
    <button class="close-x" id="d-close" aria-label="Cerrar">×</button>
    <div class="detail-media"><img id="d-img" alt="Producto" /></div>
    <div class="detail-body">
      <h2 class="detail-title" id="d-title"></h2>
      <div class="detail-meta" id="d-meta"></div>
      <div class="prices">
        <div class="p-usd" id="d-usd"></div>
        <div class="p-ars" id="d-ars"></div>
        <div class="p-cuotas" id="d-cuotas"></div>
      </div>
      <div class="detail-actions">
        <button class="cta" id="d-later">Después</button>
        <button class="cta primary" id="d-contact">Consultar</button>
      </div>
    </div>
  </div>
</div>

<footer>
  <div class="wrap">Se actualiza automáticamente cuando cambias la base de Notion (pull por CRON).</div>
</footer>

<script>
  // Dataset embebido
  window.__PRODUCTS__ = JSON.parse(atob('W3siX3JhdyI6e30sIk5hbWUiOiJTaW4gbm9tYnJlIiwiUHJpY2VVU0QiOm51bGwsIlByaWNlQVJTIjpudWxsLCJQcmljZUxhYmVsIjoi4oCUIiwiQmF0dGVyeSI6bnVsbCwiU3RvcmFnZSI6IuKAlCIsIk1vZGVsbyI6bnVsbCwiQ29sb3IiOm51bGwsIkN1b3RhMyI6bnVsbCwiQ3VvdGE2IjpudWxsLCJTdGF0dXMiOiIiLCJJbWFnZVVSTCI6IiJ9XQ=='));

  // Beneficios una vez por sesión
  (function(){
    const key = 'goapple_welcome_seen';
    const seen = sessionStorage.getItem(key);
    const $ov = document.getElementById('welcome');
    if(!seen){ $ov.style.display = 'flex'; }
    function close(){ $ov.style.display='none'; sessionStorage.setItem(key,'1'); }
    document.getElementById('dismiss')?.addEventListener('click', close);
    document.getElementById('see')?.addEventListener('click', close);
    $ov.addEventListener('click', (e)=>{ if(e.target === $ov) close(); });
  })();

  // Helpers en el cliente (mismos que arriba)
  const COLOR_MAP = {"negro":"#111827","black":"#111827","midnight":"#0b1324","graphite":"#3a3a3c","blanco":"#f9fafb","white":"#f9fafb","starlight":"#f5f1e6","silver":"#d1d5db","azul":"#1d4ed8","blue":"#1d4ed8","deep purple":"#5b21b6","purple":"#7c3aed","rojo":"#dc2626","red":"#dc2626","verde":"#16a34a","green":"#16a34a","dorado":"#eab308","gold":"#eab308","rosa":"#fb7185","pink":"#fb7185"};
  const colorToHex = (name)=>{ if(!name) return '#d1d5db'; const key=String(name).trim().toLowerCase(); for(const k in COLOR_MAP){ if(key.includes(k)) return COLOR_MAP[k]; } return '#d1d5db'; };
  const battColor = (pct)=>{ const p=Math.max(0,Math.min(100,Number(pct)||0)); const h=Math.round(p*1.2); return `hsl(${h} 70% 45%)`; };
  const esc = (s)=> String(s ?? '').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
  const fmtMoney = (v,currency)=>{ if (v==null||v==='') return null; const n=Number(v); if(!isFinite(n)) return null; if(currency==='ARS') return '$ '+n.toLocaleString('es-AR'); if(currency==='USD') return 'USD '+n.toLocaleString('en-US'); return '$'+n; };

  // Abrir detalle al click
  const grid = document.getElementById('grid');
  grid.addEventListener('click', (e)=>{
    const hit = e.target.closest('.card');
    if(!hit) return;
    const idx = Number(hit.dataset.idx);
    const p = window.__PRODUCTS__[idx];
    if(!p) return;

    const $ov = document.getElementById('detail');
    const $img = document.getElementById('d-img');
    const $title = document.getElementById('d-title');
    const $meta = document.getElementById('d-meta');
    const $usd = document.getElementById('d-usd');
    const $ars = document.getElementById('d-ars');
    const $cuo = document.getElementById('d-cuotas');

    $img.src = p.ImageURL || '';
    $img.alt = p.Name;
    $title.textContent = p.Name;

    // chips: Color • Almacenamiento • Batería
    const chips = [];
    if(p.Color){ chips.push(`<span class="chip"><i class="dot" style="--dot:${colorToHex(p.Color)}"></i>${esc(p.Color)}</span>`); }
    if(p.Storage && p.Storage !== '—'){ chips.push(`<span class="chip"><i class="dot" style="--dot:#9ca3af"></i>${esc(p.Storage)}</span>`); }
    if(p.Battery!=null){ chips.push(`<span class="chip"><i class="dot" style="--dot:${battColor(p.Battery)}"></i>${p.Battery}%</span>`); }
    $meta.innerHTML = chips.join('');

    // precios: USD (arriba), ARS (abajo)
    $usd.textContent = fmtMoney(p.PriceUSD,'USD') ?? 'USD —';
    $ars.textContent = fmtMoney(p.PriceARS,'ARS') ?? '$ —';

    // cuotas
    const c3 = p.Cuota3 ? `3x ${esc(p.Cuota3)}` : '';
    const c6 = p.Cuota6 ? `6x ${esc(p.Cuota6)}` : '';
    $cuo.textContent = (c3 || c6) ? [c3,c6].filter(Boolean).join('  •  ') : 'Consultar financiación';

        // acciones (WhatsApp)
    document.getElementById('d-contact').onclick = function () {
      const msg = encodeURIComponent('Me interesa el ' + p.Name + '. ¿Está disponible?');
      const url = 'https://wa.me/' + '5492646721845' + '?text=' + msg;
      window.open(url, '_blank');
    };


    // abrir y bindings de cierre
    $ov.style.display = 'flex';
  });

  // Cerrar modal de detalle
  (function(){
    const $ov = document.getElementById('detail');
    function close(){ $ov.style.display='none'; }
    document.getElementById('d-close').addEventListener('click', close);
    document.getElementById('d-later').addEventListener('click', close);
    $ov.addEventListener('click', (e)=>{ if(e.target === $ov) close(); });
    window.addEventListener('keydown', (e)=>{ if(e.key==='Escape') close(); });
  })();
</script>

</body>
</html>